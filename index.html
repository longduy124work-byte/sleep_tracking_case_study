<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sleep Tracker App</title>
    <!--Bootstrap CSS-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="style.css" rel="stylesheet">
    <script src="script.js"></script>
</head>

<body>

    <!--Modal-->
    <div class="modal" tabindex="-1" id="input-modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Cập nhật giờ ngủ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <lable for="bed-time">Input your bed time</lable> <br>
                    <input id="bed-time" type="time"> <br>
                    <lable for="wakeup-time">Input your wake up time</lable> <br>
                    <input id="wakeup-time" type="time"> <br>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="save()" >Save changes</button>
                </div>
            </div>
        </div>
    </div>
    <div id="all-week-quality"></div>
    <table id="fullWeek"></table>
    <div id="detail"></div>
    <div id="totalHour"></div>
    <script>
        // Đối tượng SleepDate
        let day1 = new SleepDate(1, "Mon", "22-12-2025");
        let day2 = new SleepDate(2, "Tue", "23-12-2025");
        let day3 = new SleepDate(3, "Wed", "24-12-2025");
        let day4 = new SleepDate(4, "Thu", "25-12-2025");
        let day5 = new SleepDate(5, "Fri", "26-12-2025");
        let day6 = new SleepDate(6, "Sat", "27-12-2025");
        let day7 = new SleepDate(7, "Sun", "28-12-2025");
        let days = [day1, day2, day3, day4, day5, day6, day7];

         // Đối tượng SleepOverall
        let allWeekSleep = new SleepOverall()
        // Tính tổng giấc ngủ trong tuần
        allWeekSleep.calWeekTotalSleep(days);
        function displayAllWeekQuality() {
            let quality = allWeekSleep.getWeekTotalSleep();
            document.getElementById("all-week-quality").innerHTML = quality;
        }
        displayAllWeekQuality();

        // nhận biết ngày nào đang được chọn
        let currentEditingDayId = null;
        
        function displayDate() {
            let str = "<tr>"
            for (let i = 0; i < days.length; i++) {
                str += `<td onclick='displayDetail(${days[i].id})'>` + days[i].getFullDay() + "</td>"
            }
            str += "</tr>"
            document.getElementById("fullWeek").innerHTML = str;


        }
        displayDate();

        function displayDetail(id) {
            let day = getDayById(id);
            currentEditingDayId = id;
            let detailRecord = day.getFullTime();
            let totalHour = day.getTotalHours();
            document.getElementById("detail").innerHTML = detailRecord;
            document.getElementById("totalHour").innerHTML = totalHour;
        }

        function getDayById(id) {
            for (let i = 0; i < days.length; i++) {
                if (days[i].id === id) {
                    return days[i];
                }
            }
            return null;
        }

        function save() {
            let bedTimeInput = document.getElementById("bed-time").value;
            let wakeupTimeInput = document.getElementById("wakeup-time").value;
            let day = getDayById(currentEditingDayId);
            day.updateSleepTime(bedTimeInput, wakeupTimeInput);
            console.log(day.bedTime);
            displayDetail(currentEditingDayId);

            //cập nhật lại tổng giờ ngủ cả tuần
             allWeekSleep.calWeekTotalSleep(days);
             displayAllWeekQuality();
        }


        
    </script>
    <!--Bootstrap JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
</body>

</html>